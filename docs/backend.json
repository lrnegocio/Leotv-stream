{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the VideoVerse Player application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "username": {
          "type": "string",
          "description": "The username of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "freeTrialExpiry": {
          "type": "string",
          "description": "The date and time when the user's free trial expires, if applicable.",
          "format": "date-time"
        },
        "isBlocked": {
          "type": "boolean",
          "description": "Indicates whether the user is currently blocked from accessing the application."
        }
      },
      "required": [
        "id",
        "username",
        "email"
      ]
    },
    "Admin": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Admin",
      "type": "object",
      "description": "Represents an administrator of the VideoVerse Player application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Admin entity."
        },
        "username": {
          "type": "string",
          "description": "The username of the admin."
        },
        "email": {
          "type": "string",
          "description": "The email address of the admin.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "username",
        "email"
      ]
    },
    "Channel": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Channel",
      "type": "object",
      "description": "Represents a video or radio channel available on the VideoVerse Player.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Channel entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the channel."
        },
        "description": {
          "type": "string",
          "description": "A description of the channel."
        },
        "channelUrl": {
          "type": "string",
          "description": "The URL of the channel's video or audio stream.",
          "format": "uri"
        },
        "channelType": {
          "type": "string",
          "description": "The Type of Channel being implemented (video or radio)."
        }
      },
      "required": [
        "id",
        "name",
        "channelUrl"
      ]
    },
    "Episode": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Episode",
      "type": "object",
      "description": "Represents an episode within a channel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Episode entity."
        },
        "channelId": {
          "type": "string",
          "description": "Reference to Channel. (Relationship: Channel 1:N Episode)"
        },
        "episodeNumber": {
          "type": "number",
          "description": "The episode number within the season."
        },
        "episodeUrl": {
          "type": "string",
          "description": "The URL of the episode's video or audio stream.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "channelId",
        "episodeNumber",
        "episodeUrl"
      ]
    },
    "Season": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Season",
      "type": "object",
      "description": "Represents a season of episodes within a channel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Season entity."
        },
        "channelId": {
          "type": "string",
          "description": "Reference to Channel. (Relationship: Channel 1:N Season)"
        },
        "seasonNumber": {
          "type": "number",
          "description": "The season number."
        }
      },
      "required": [
        "id",
        "channelId",
        "seasonNumber"
      ]
    },
    "Session": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Session",
      "type": "object",
      "description": "Represents a user's session for preventing dual login.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Session entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Session)"
        },
        "loginTime": {
          "type": "string",
          "description": "The date and time when the user logged in.",
          "format": "date-time"
        },
        "deviceInfo": {
          "type": "string",
          "description": "Information about the device used for the session (e.g., browser, operating system)."
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the session is currently active."
        }
      },
      "required": [
        "id",
        "userId",
        "loginTime",
        "isActive"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Includes 'id', 'username', 'email', 'freeTrialExpiry', and 'isBlocked'. Path-based ownership ensures only the user can modify their own data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{adminId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/backend/entities/Admin"
          },
          "description": "Stores admin UIDs. Existence of a document for a given UID in this collection grants admin privileges.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier of the admin."
            }
          ]
        }
      },
      {
        "path": "/channels/{channelId}",
        "definition": {
          "entityName": "Channel",
          "schema": {
            "$ref": "#/backend/entities/Channel"
          },
          "description": "Stores channel information, including 'name', 'description', and 'channelUrl'.",
          "params": [
            {
              "name": "channelId",
              "description": "The unique identifier of the channel."
            }
          ]
        }
      },
      {
        "path": "/channels/{channelId}/seasons/{seasonId}",
        "definition": {
          "entityName": "Season",
          "schema": {
            "$ref": "#/backend/entities/Season"
          },
          "description": "Stores season information for a channel. Includes 'seasonNumber'.",
          "params": [
            {
              "name": "channelId",
              "description": "The unique identifier of the channel."
            },
            {
              "name": "seasonId",
              "description": "The unique identifier of the season."
            }
          ]
        }
      },
      {
        "path": "/channels/{channelId}/seasons/{seasonId}/episodes/{episodeId}",
        "definition": {
          "entityName": "Episode",
          "schema": {
            "$ref": "#/backend/entities/Episode"
          },
          "description": "Stores episode information for a season within a channel. Includes 'episodeNumber' and 'episodeUrl'.",
          "params": [
            {
              "name": "channelId",
              "description": "The unique identifier of the channel."
            },
            {
              "name": "seasonId",
              "description": "The unique identifier of the season."
            },
            {
              "name": "episodeId",
              "description": "The unique identifier of the episode."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/sessions/{sessionId}",
        "definition": {
          "entityName": "Session",
          "schema": {
            "$ref": "#/backend/entities/Session"
          },
          "description": "Stores user session data to prevent dual login. Includes 'loginTime', 'deviceInfo', and 'isActive'.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "sessionId",
              "description": "The unique identifier of the session."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to provide a secure, scalable, and manageable data model for the VideoVerse Player application. The core principle is Authorization Independence, achieved through denormalization of access control data. This eliminates the need for `get()` calls in security rules, enabling atomic operations and simplifying debugging.\n\n**Authorization Independence & QAPs:**\n\n*   **Users:** User data is stored under `/users/{userId}` ensuring path-based ownership. User-specific data remains private to the user.\n*   **Admins:** Admin UIDs are stored in `/roles_admin/{uid}`.  The existence of a document for a given `uid` in this collection grants admin privileges. This approach avoids needing to read user documents to verify admin roles.\n*   **Channels, Seasons, Episodes:** These entities are stored under a top-level collection `/channels/{channelId}`, `/channels/{channelId}/seasons/{seasonId}`, `/channels/{channelId}/seasons/{seasonId}/episodes/{episodeId}` respectively. These collections can be read by all users; authorization independence is unnecessary here.\n*   **Sessions:** Stored under `/users/{userId}/sessions/{sessionId}`. Enforces one session per user.\n\n**Data Clarity and Predictability:**\n\n*   Consistent naming conventions are used throughout the database (e.g., `userId`, `channelId`).\n*   The `isBlocked` field in the `/users/{userId}` collection explicitly models the user's blocked status."
  }
}